<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>MVVM</title>
</head>
<body>

<script>

var data = {
  name: 'king',
  age: 100
}

observe(data);
data.name = 'Queen';
data.age = 80;

function observe (data) {
  if (!data || typeof data !== 'object') {
    return;
  }
  // 取出所有属性遍历
  Object.keys(data).forEach(function (key) {
    defineReactive(data, key, data[key]);
  });
}

function defineReactive (data, key, val) {
  observe(val);  // 监听子属性
  Object.defineProperty(data, key, {
    enumerable: true,  // 可枚举
    configuraable: false, // 不能再define
    get: function () {
      return val;
    },
    set: function (newVal) {
      if (val === newVal) return;
      console.log('监听到值变化', val, '--->', newVal);
      val = newVal;
    }
  })
}
</script>
</body>
</html>